<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raporlar - SÃ¼t Takip Sistemi</title>
  <meta name="description" content="SÃ¼t Ã¼retimi raporlarÄ± ve analizleri">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="/icons/favicon.ico" type="image/x-icon">
  <meta name="theme-color" content="#4CAF50">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { 
      max-width: 1400px; 
      margin: auto; 
      background: white; 
      border-radius: 15px; 
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      padding: 30px;
      text-align: center;
      position: relative;
    }
    .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
    .header p { opacity: 0.9; font-size: 1.1rem; }
    .back-btn {
      position: absolute;
      left: 30px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.2);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background 0.3s;
    }
    .back-btn:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      padding: 30px;
      background: #f8f9fa;
    }
    .stat-card {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      transition: transform 0.3s;
    }
    .stat-card:hover {
      transform: translateY(-5px);
    }
    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 8px;
    }
    .stat-label {
      opacity: 0.9;
      font-size: 0.9rem;
    }
    
    .filter-section {
      background: #f8f9fa;
      padding: 30px;
      border-bottom: 1px solid #e1e5e9;
    }
    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
    }
    .form-group label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }
    .form-group select,
    .form-group input {
      padding: 12px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    .form-group select:focus,
    .form-group input:focus {
      outline: none;
      border-color: #4CAF50;
    }
    
    .btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
      margin: 5px;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 15px rgba(76, 175, 80, 0.3);
    }
    .btn-secondary {
      background: linear-gradient(135deg, #6c757d, #5a6268);
    }
    .btn-danger {
      background: linear-gradient(135deg, #dc3545, #c82333);
    }
    
    .data-section {
      padding: 30px;
    }
    .search-box {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 1rem;
    }
    .data-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .data-table th,
    .data-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e1e5e9;
    }
    .data-table th {
      background: #4CAF50;
      color: white;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .data-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    .data-table tr:hover {
      background: #e8f5e8;
    }
    
    .chart-section {
      padding: 30px;
      background: white;
    }
    .chart-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .chart-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 15px;
      color: #333;
    }
    
    .no-data {
      text-align: center;
      padding: 50px;
      color: #666;
      font-size: 1.1rem;
    }
    
    .export-section {
      padding: 20px 30px;
      background: #f8f9fa;
      border-top: 1px solid #e1e5e9;
      text-align: center;
    }
    
    @media (max-width: 768px) {
      .filter-grid { grid-template-columns: 1fr; }
      .stats-grid { grid-template-columns: 1fr; }
      .header h1 { font-size: 1.8rem; }
      .back-btn { position: static; margin-bottom: 10px; }
      .data-table { font-size: 0.9rem; }
      .data-table th,
      .data-table td { padding: 8px; }
    }
    
    .loading {
      text-align: center;
      padding: 50px;
      font-size: 1.1rem;
      color: #666;
    }
    
    .summary-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .trend-indicator {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      font-weight: bold;
    }
    .trend-up { background: #d4edda; color: #155724; }
    .trend-down { background: #f8d7da; color: #721c24; }
    .trend-stable { background: #fff3cd; color: #856404; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="/" class="back-btn">ğŸ”™ Ana Sayfa</a>
      <h1>ğŸ“Š SÃ¼t Ãœretimi RaporlarÄ±</h1>
      <p>DetaylÄ± analiz ve raporlama paneli</p>
    </div>
    
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="toplam-uretim">0</div>
        <div class="stat-label">Toplam Ãœretim (L)</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="gunluk-ortalama">0</div>
        <div class="stat-label">GÃ¼nlÃ¼k Ortalama (L)</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="aktif-uretici">0</div>
        <div class="stat-label">Aktif Ãœretici</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="ortalama-kalite">0</div>
        <div class="stat-label">Ortalama YaÄŸ (%)</div>
      </div>
    </div>
    
    <div class="filter-section">
      <h3>Filtreler</h3>
      <div class="filter-grid">
        <div class="form-group">
          <label for="filtre-koy">KÃ¶y:</label>
          <select id="filtre-koy" onchange="raporlariFiltrele()">
            <option value="">TÃ¼mÃ¼</option>
            <option value="KÃ¶y 1">KÃ¶y 1</option>
            <option value="KÃ¶y 2">KÃ¶y 2</option>
            <option value="KÃ¶y 3">KÃ¶y 3</option>
            <option value="KÃ¶y 4">KÃ¶y 4</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="filtre-musta">MÃ¼stahsil:</label>
          <select id="filtre-musta" onchange="raporlariFiltrele()">
            <option value="">TÃ¼mÃ¼</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="baslangic-tarih">BaÅŸlangÄ±Ã§ Tarihi:</label>
          <input type="date" id="baslangic-tarih" onchange="raporlariFiltrele()">
        </div>
        
        <div class="form-group">
          <label for="bitis-tarih">BitiÅŸ Tarihi:</label>
          <input type="date" id="bitis-tarih" onchange="raporlariFiltrele()">
        </div>
      </div>
      
      <div style="margin-top: 15px;">
        <button class="btn" onclick="raporlariFiltrele()">ğŸ” Filtrele</button>
        <button class="btn btn-secondary" onclick="filtreleriTemizle()">ğŸ§¹ Temizle</button>
        <button class="btn btn-secondary" onclick="bugunRaporu()">ğŸ“… BugÃ¼n</button>
        <button class="btn btn-secondary" onclick="haftaRaporu()">ğŸ“… Bu Hafta</button>
        <button class="btn btn-secondary" onclick="ayRaporu()">ğŸ“… Bu Ay</button>
      </div>
    </div>
    
    <div class="chart-section">
      <div class="chart-container">
        <div class="chart-title">GÃ¼nlÃ¼k Ãœretim Trendi (Son 7 GÃ¼n)</div>
        <canvas id="trendGrafik" width="800" height="300"></canvas>
      </div>
      
      <div class="chart-container">
        <div class="chart-title">KÃ¶y BazÄ±nda Ãœretim DaÄŸÄ±lÄ±mÄ±</div>
        <canvas id="dagÄ±lÄ±mGrafik" width="800" height="300"></canvas>
      </div>
    </div>
    
    <div class="data-section">
      <h3>Veri Tablosu</h3>
      <input type="text" id="arama" class="search-box" placeholder="ğŸ” Ara... (mÃ¼stahsil adÄ±, kÃ¶y, tarih)" oninput="tabloAra()">
      
      <div style="overflow-x: auto;">
        <table class="data-table" id="raporTablosu">
          <thead>
            <tr>
              <th onclick="tabloSirala('tarih')">Tarih â†•ï¸</th>
              <th onclick="tabloSirala('koy')">KÃ¶y â†•ï¸</th>
              <th onclick="tabloSirala('musta')">MÃ¼stahsil â†•ï¸</th>
              <th onclick="tabloSirala('ogun')">Ã–ÄŸÃ¼n â†•ï¸</th>
              <th onclick="tabloSirala('miktar')">Miktar (L) â†•ï¸</th>
              <th onclick="tabloSirala('yagOrani')">YaÄŸ (%) â†•ï¸</th>
              <th onclick="tabloSirala('proteinOrani')">Protein (%) â†•ï¸</th>
              <th onclick="tabloSirala('sicaklik')">SÄ±caklÄ±k (Â°C) â†•ï¸</th>
              <th>Ä°ÅŸlemler</th>
            </tr>
          </thead>
          <tbody id="tabloIcerik">
            <tr>
              <td colspan="9" class="loading">Veriler yÃ¼kleniyor...</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div id="veriYok" class="no-data" style="display: none;">
        <h3>ğŸ“­ Veri BulunamadÄ±</h3>
        <p>SeÃ§ilen kriterlere uygun veri bulunmamaktadÄ±r.</p>
        <button class="btn" onclick="window.location.href='/'">â• Yeni KayÄ±t Ekle</button>
      </div>
    </div>
    
    <div class="export-section">
      <h3>DÄ±ÅŸa Aktarma</h3>
      <button class="btn" onclick="csvIndir()">ğŸ“„ CSV Ä°ndir</button>
      <button class="btn" onclick="excelIndir()">ğŸ“Š Excel Ä°ndir</button>
      <button class="btn" onclick="pdfOlustur()">ğŸ“‘ PDF Rapor</button>
      <button class="btn btn-secondary" onclick="yazdÄ±r()">ğŸ–¨ï¸ YazdÄ±r</button>
    </div>
  </div>
  
  <script>
    // Global deÄŸiÅŸkenler
    let sutVerileri = JSON.parse(localStorage.getItem('sutVerileri') || '[]');
    let filtreliVeriler = [...sutVerileri];
    let siralamaDurumu = { alan: '', yÃ¶n: 'asc' };
    
    const MUSTAHSIL_LISTESI = {
      "KÃ¶y 1": ["Ayhan","SÃ¼leyman","Engin","Selahattin","Nevzat","GÃ¶kmen","A. GÃ¶kdaÄŸ","HÃ¼snÃ¼","Ä°smail","Emine","Berrin","BayramalÄ±","Kemal","ÅÃ¼kriye Can","Ä°. DuraklÄ±","M. Bayraktar","Mithat","Necati","A. YalÃ§Ä±n","Bilgin","Necami","H. BÃ¼yer","A. YÃ¼ksel","Ergin"],
      "KÃ¶y 2": ["Ahmet","Emrah","Ãœmit","Ender","Mehmet","Okan","Hakan","Cemalettin","Hulisi","Fikret"],
      "KÃ¶y 3": ["H. Boz","Nadir","Nejat","A. DurmuÅŸ","Ã–. DurmuÅŸ","Harun","RÃ¼stem","Ãœsret","Sevim","GÃ¼ray","A. Kahveci","A. Ã‡etin","NazlÄ±","Rasit","Zerrin"],
      "KÃ¶y 4": ["C. KaÃ§an","Ä°t. Kontor","MÃ¼krinat","M. YÄ±ldÄ±z","M. Åahin","Zeki","Vasif","S. AyalÄ±n","Sevgi","A. AydÄ±n","M. AydÄ±n"]
    };
    
    // Sayfa yÃ¼klendiÄŸinde
    document.addEventListener('DOMContentLoaded', function() {
      mustahsilListesiniDoldur();
      tarihFiltreleriniAyarla();
      istatistikleriHesapla();
      raporlariFiltrele();
      grafikleriCiz();
      
      // Service Worker kayÄ±t
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/service-worker.js');
      }
    });
    
    // MÃ¼stahsil listesini doldur
    function mustahsilListesiniDoldur() {
      const select = document.getElementById('filtre-musta');
      const tumMustahsiller = new Set();
      
      Object.values(MUSTAHSIL_LISTESI).forEach(liste => {
        liste.forEach(ad => tumMustahsiller.add(ad));
      });
      
      Array.from(tumMustahsiller).sort().forEach(ad => {
        const option = document.createElement('option');
        option.value = ad;
        option.textContent = ad;
        select.appendChild(option);
      });
    }
    
    // Tarih filtrelerini ayarla
    function tarihFiltreleriniAyarla() {
      const bugun = new Date().toISOString().split('T')[0];
      const ayOnce = new Date(Date.now() - 30*24*60*60*1000).toISOString().split('T')[0];
      
      document.getElementById('baslangic-tarih').value = ayOnce;
      document.getElementById('bitis-tarih').value = bugun;
    }
    
    // Ä°statistikleri hesapla
    function istatistikleriHesapla() {
      const toplamUretim = filtreliVeriler.reduce((sum, v) => sum + v.miktar, 0);
      const gunSayisi = new Set(filtreliVeriler.map(v => v.tarih)).size || 1;
      const gunlukOrtalama = toplamUretim / gunSayisi;
      const aktifUretici = new Set(filtreliVeriler.map(v => v.musta)).size;
      const ortalamaKalite = filtreliVeriler.length > 0 
        ? filtreliVeriler.reduce((sum, v) => sum + (v.yagOrani || 0), 0) / filtreliVeriler.length
        : 0;
      
      document.getElementById('toplam-uretim').textContent = toplamUretim.toFixed(1);
      document.getElementById('gunluk-ortalama').textContent = gunlukOrtalama.toFixed(1);
      document.getElementById('aktif-uretici').textContent = aktifUretici;
      document.getElementById('ortalama-kalite').textContent = ortalamaKalite.toFixed(1);
    }
    
    // RaporlarÄ± filtrele
    function raporlariFiltrele() {
      const koy = document.getElementById('filtre-koy').value;
      const musta = document.getElementById('filtre-musta').value;
      const baslangic = document.getElementById('baslangic-tarih').value;
      const bitis = document.getElementById('bitis-tarih').value;
      
      filtreliVeriler = sutVerileri.filter(veri => {
        let uygun = true;
        
        if (koy && veri.koy !== koy) uygun = false;
        if (musta && veri.musta !== musta) uygun = false;
        if (baslangic && veri.tarih < baslangic) uygun = false;
        if (bitis && veri.tarih > bitis) uygun = false;
        
        return uygun;
      });
      
      istatistikleriHesapla();
      tabloGuncelle();
      grafikleriCiz();
    }
    
    // Tabloyu gÃ¼ncelle
    function tabloGuncelle() {
      const tbody = document.getElementById('tabloIcerik');
      const veriYokDiv = document.getElementById('veriYok');
      
      if (filtreliVeriler.length === 0) {
        tbody.innerHTML = '';
        veriYokDiv.style.display = 'block';
        return;
      }
      
      veriYokDiv.style.display = 'none';
      
      // SÄ±ralama uygula
      if (siralamaDurumu.alan) {
        filtreliVeriler.sort((a, b) => {
          let aVal = a[siralamaDurumu.alan];
          let bVal = b[siralamaDurumu.alan];
          
          if (typeof aVal === 'string') {
            aVal = aVal.toLowerCase();
            bVal = bVal.toLowerCase();
          }
          
          if (siralamaDurumu.yÃ¶n === 'asc') {
            return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
          } else {
            return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
          }
        });
      }
      
      tbody.innerHTML = filtreliVeriler.map(veri => `
        <tr>
          <td>${veri.tarih}</td>
          <td>${veri.koy}</td>
          <td>${veri.musta}</td>
          <td>${veri.ogun === 'Sabah' ? 'ğŸŒ…' : 'ğŸŒ†'} ${veri.ogun}</td>
          <td><strong>${veri.miktar.toFixed(1)}</strong></td>
          <td>${(veri.yagOrani || 0).toFixed(1)}</td>
          <td>${(veri.proteinOrani || 0).toFixed(1)}</td>
          <td>${(veri.sicaklik || 0).toFixed(1)}</td>
          <td>
            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;" 
                    onclick="kayitSil(${veri.id})">ğŸ—‘ï¸</button>
          </td>
        </tr>
      `).join('');
    }
    
    // Tablo sÄ±ralama
    function tabloSirala(alan) {
      if (siralamaDurumu.alan === alan) {
        siralamaDurumu.yÃ¶n = siralamaDurumu.yÃ¶n === 'asc' ? 'desc' : 'asc';
      } else {
        siralamaDurumu.alan = alan;
        siralamaDurumu.yÃ¶n = 'asc';
      }
      
      tabloGuncelle();
    }
    
    // Tablo arama
    function tabloAra() {
      const arama = document.getElementById('arama').value.toLowerCase();
      const satirlar = document.querySelectorAll('#tabloIcerik tr');
      
      satirlar.forEach(satir => {
        const metin = satir.textContent.toLowerCase();
        satir.style.display = metin.includes(arama) ? '' : 'none';
      });
    }
    
    // KayÄ±t silme
    function kayitSil(id) {
      if (confirm('Bu kaydÄ± silmek istediÄŸinizden emin misiniz?')) {
        sutVerileri = sutVerileri.filter(v => v.id !== id);
        localStorage.setItem('sutVerileri', JSON.stringify(sutVerileri));
        raporlariFiltrele();
        alert('KayÄ±t silindi.');
      }
    }
    
    // HÄ±zlÄ± filtreler
    function bugunRaporu() {
      const bugun = new Date().toISOString().split('T')[0];
      document.getElementById('baslangic-tarih').value = bugun;
      document.getElementById('bitis-tarih').value = bugun;
      raporlariFiltrele();
    }
    
    function haftaRaporu() {
      const bugun = new Date().toISOString().split('T')[0];
      const haftaOnce = new Date(Date.now() - 7*24*60*60*1000).toISOString().split('T')[0];
      document.getElementById('baslangic-tarih').value = haftaOnce;
      document.getElementById('bitis-tarih').value = bugun;
      raporlariFiltrele();
    }
    
    function ayRaporu() {
      const bugun = new Date().toISOString().split('T')[0];
      const ayOnce = new Date(Date.now() - 30*24*60*60*1000).toISOString().split('T')[0];
      document.getElementById('baslangic-tarih').value = ayOnce;
      document.getElementById('bitis-tarih').value = bugun;
      raporlariFiltrele();
    }
    
    // Filtreleri temizle
    function filtreleriTemizle() {
      document.getElementById('filtre-koy').value = '';
      document.getElementById('filtre-musta').value = '';
      tarihFiltreleriniAyarla();
      raporlariFiltrele();
    }
    
    // Grafikleri Ã§iz
    function grafikleriCiz() {
      trendGrafigiCiz();
      dagÄ±lÄ±mGrafigiCiz();
    }
    
    // Trend grafiÄŸi
    function trendGrafigiCiz() {
      const canvas = document.getElementById('trendGrafik');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Son 7 gÃ¼nÃ¼n verilerini hazÄ±rla
      const son7Gun = [];
      for (let i = 6; i >= 0; i--) {
        const tarih = new Date(Date.now() - i*24*60*60*1000).toISOString().split('T')[0];
        const gunToplam = filtreliVeriler
          .filter(v => v.tarih === tarih)
          .reduce((sum, v) => sum + v.miktar, 0);
        son7Gun.push({ tarih, miktar: gunToplam });
      }
      
      if (son7Gun.every(g => g.miktar === 0)) {
        ctx.fillStyle = '#666';
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('Veri bulunamadÄ±', canvas.width/2, canvas.height/2);
        return;
      }
      
      // Grafik Ã§izimi
      const padding = 60;
      const genislik = canvas.width - 2 * padding;
      const yukseklik = canvas.height - 2 * padding;
      const maxMiktar = Math.max(...son7Gun.map(g => g.miktar), 1);
      
      // Eksenler
      ctx.strokeStyle = '#ddd';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(padding, padding);
      ctx.lineTo(padding, canvas.height - padding);
      ctx.lineTo(canvas.width - padding, canvas.height - padding);
      ctx.stroke();
      
      // Ã‡izgi grafiÄŸi
      ctx.strokeStyle = '#4CAF50';
      ctx.lineWidth = 3;
      ctx.beginPath();
      
      son7Gun.forEach((gun, index) => {
        const x = padding + (index * genislik / 6);
        const y = canvas.height - padding - (gun.miktar / maxMiktar * yukseklik);
        
        if (index === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
        
        // Nokta
        ctx.save();
        ctx.fillStyle = '#4CAF50';
        ctx.beginPath();
        ctx.arc(x, y, 5, 0, 2 * Math.PI);
        ctx.fill();
        ctx.restore();
        
        // Tarih etiketi
        ctx.save();
        ctx.fillStyle = '#666';
        ctx.font = '12px Arial';
        ctx.textAlign = 'center';
        const tarihKisa = gun.tarih.split('-')[2] + '/' + gun.tarih.split('-')[1];
        ctx.fillText(tarihKisa, x, canvas.height - padding + 20);
        
        // DeÄŸer etiketi
        ctx.fillText(gun.miktar.toFixed(1) + 'L', x, y - 10);
        ctx.restore();
      });
      
      ctx.stroke();
      
      // Y ekseni etiketleri
      ctx.fillStyle = '#666';
      ctx.font = '12px Arial';
      ctx.textAlign = 'right';
      for (let i = 0; i <= 5; i++) {
        const y = canvas.height - padding - (i * yukseklik / 5);
        const deger = (maxMiktar * i / 5).toFixed(0);
        ctx.fillText(deger + 'L', padding - 10, y + 4);
      }
    }
    
    // DaÄŸÄ±lÄ±m grafiÄŸi
    function dagÄ±lÄ±mGrafigiCiz() {
      const canvas = document.getElementById('dagÄ±lÄ±mGrafik');
      const ctx = canvas.
